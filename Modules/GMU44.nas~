var GMU44 = {
	new: func()
	{
		var m = { parents: [GMU44] };
		m.links = [];
		return m;
		m.runing = thread.newlock()
	},
	setup: func(link)
	{
		append(me.links,link);
		print('link OK');
	},
	run: func()
	{
		thread.lock(me.running);
		thread.newthread(me.threatStart);
	},
	threatStart: func()
	{
	  me.update()
	  thread.lock(me.running)
	  thread.unlock(me.running)
	}
	update: func()
	{
		
		senddata = getprop('/orientation/heading-magnetic-deg');
		print(senddata);
		foreach(var link; me.links)
		{
			link(sendData);
		}
		settimer(me.update,0);
	},
	shutdown
};

#test data
test = func(data)
{
	print(data);
};
compass = GMU44.new();
compass.setup(test);
compass.run();
